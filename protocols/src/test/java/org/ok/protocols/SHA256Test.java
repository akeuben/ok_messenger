package org.ok.protocols;

import org.ok.protocols.hmacsha256.*;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;

public class SHA256Test {

    @Test
    void testSHA256() {
        Block msg = new Block(
                "12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890");

        Block expected = Block.fromHexString("7e51185cf0f1e29560c6201d479b4e67374a0141bfea88ab3c2bc181357fa82f");

        assertEquals(expected, SHA256.sha256(msg));
    }

    @Test
    void testHMAC256() {
        Block msg = new Block("This is a test");

        Block key = new Block(
                "12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890");

        Block expected = Block.fromHexString("28719ace8a5a706faf0cea918d8d496a9d5fe8363311c95a1172ed556424a328");
        // Block expected =
        // Block.fromHexString("c11a3be6b35866216b73b8f13ebc97cba97966d3096a547d7133d617daa5c91c");

        assertEquals(expected, HMAC.encode(msg, key));
    }
}
